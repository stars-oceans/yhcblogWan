---
post: true
title: 照片上传加实现即时预览
date: 2024-01-31
cover: https://i.postimg.cc/wjMK0mcY/studyroom-standard.webp
coveross: https://i.postimg.cc/wjMK0mcY/studyroom-standard.webp
# 分类
categories:
 - 业务
tags:
 - 文件上传
 - 图片
description: 照片上传加实现即时预览
---

# 实现即时预览
## 1. File 转 base64 实现即时预览
```vue
<template>
  <div>
    <!-- 文件输入框，当选择文件后触发change事件 -->
    <input type="file" @change="previewImage">
    <!-- 预览图片，当有imageUrl时显示 -->
    <img v-if="imageUrl" :src="imageUrl" style="max-width: 100%; height: auto;">
  </div>
</template>
<!-- base64 -->
<script>
export default {
  data() {
    return {
      imageUrl: null // 存储预览图片的DataURL
    };
  },
  methods: {
    previewImage(event) {
      const file = event.target.files[0]; // 获取选择的文件
      const reader = new FileReader(); // 创建FileReader对象用于读取文件
      reader.readAsDataURL(file); // 读取文件并将其转换为DataURL（这是一个异步操作）
      // 当文件读取完成时触发load事件，执行回调函数
      reader.onload = () => {
        this.imageUrl = reader.result; // 将读取到的文件数据URL赋值给imageUrl
        console.log(this.imageUrl);
      };

    }
  }
};
</script>

```

## File 创建对象 URL
```vue
<template>
    <div>
      <input type="file" @change="previewFile">
        <img  :src="previewUrl" style="max-width: 100%; height: auto;">
    </div>
  </template>
  
  <script>
  export default {
    data() {
      return {
        previewUrl: '',
      };
    },
    methods: {
      previewFile(event) {
        const file = event.target.files[0];
          this.previewUrl = URL.createObjectURL(file); 
      }
    }
  };
  </script>
  
```


# 对象转为 formData 文件上传给后端

```js
    var data = { name: 'andy', age: '18', file: '' };

    var formData = new FormData();
    for (var key in data) {
      if (data.hasOwnProperty(key)) {
        formData.append(key, data[key]);
      }
    }
    // 这个是给 后端的 formData
    console.log(formData);
    // 查看数据
    console.log(formData.get('name'));
```


### 注意

#### 文件对象（File对象）和FormData对象是两个不同的概念。

> File对象：是HTML5中新增的一个对象，代表了用户选择的文件。它通常用于读取文件内容、获取文件信息等操作。当用户通过文件输入框选择文件时，可以通过event.target.files来获取到File对象。File对象包含了文件的内容、名称、类型等信息。

> FormData对象：是用于创建表单数据的JavaScript API，通常用于将表单数据序列化为字符串，并将其发送到服务器。它可以用于发送多个键值对，每个键值对可以包含文本数据、文件数据等。当你需要将表单数据发送到服务器时，可以创建一个FormData对象，并通过它来组织表单数据，然后将其作为请求体发送到服务器。

在上传文件时，通常可以直接将File对象作为请求体发送到服务器。但在一些情况下，可能需要将表单数据与文件一起发送到服务器，这时就可以使用FormData对象来组织这些数据，并将其作为请求体发送到服务器。