<template>
    <!-- 对页面布局做统筹管理 -->
    <Layout :class="{ home: frontmatter?.index }">
        <template #not-found>
            <!-- 页面不存在 -->
            <ClientOnly>
                <div class="page404">
                    <PageASide type="page404" />
                </div>
            </ClientOnly>
        </template>
        <template #layout-top>
            <ClientOnly><!-- 在布局下方添加 -->
                
                <div class="snow" v-if="theme.website?.showSnow&&isDark">
                    <div v-for="index in 80" :key="index" class="dot"></div>
                </div>
                <Lantern/>
            </ClientOnly>
        </template>
        <template #nav-bar-content-after>
            <!-- 在导航 social后添加 -->
        </template>
        <template #nav-screen-content-after>

        </template>
        <template #nav-bar-content-before>

            <!-- 在导航搜索框💰添加 -->
            <ClientOnly>
                <div v-if="!isPause" class="" style="padding-left: 32px;position: relative;height:40px;margin-right:0px;">
                    <Player />
                </div>
            </ClientOnly>

        </template>
        <template #nav-bar-title-after>
            <!-- 在标题后添加 -->
        </template>
        <template #sidebar-nav-before>
            <ClientOnly>
                
                <PageNavi />
                <Firework v-if="screenWidth>960"></Firework>
                </ClientOnly>
        </template>
        <template #doc-top>
            <ClientOnly>
                <PageSlider v-if="frontmatter?.index" :key="md5(page.relativePath)"></PageSlider>
                <PageNavi v-if="frontmatter?.index" :key="md5(page.relativePath)" type="top" />
            </ClientOnly>
        </template>
        <template #doc-before>
            <ClientOnly>
                <Home v-if="frontmatter?.index" />
                <ArticleBread v-if="(frontmatter?.post)" :article="page" />
                <ArticleMetadata v-if="(frontmatter?.post)" type="single" :article="page" :key="md5(page.relativePath)" />
            </ClientOnly>
        </template>
        <template #aside-bottom>
            <ClientOnly>
                <!-- <PageGZH v-if="(frontmatter?.post)" />
                <ArticleLink v-if="(frontmatter?.post)" :key="md5(page.relativePath)" /> -->
                <PageASide v-if="(frontmatter.index)" />
            </ClientOnly>
        </template>
        <template #doc-footer-before>
            <ClientOnly>
                <ArticleCC v-if="(frontmatter?.post)" />
                <ArticleRelate v-if="(frontmatter?.post)" :key="md5(page.relativePath)" />
            </ClientOnly>
        </template>
        <template #doc-bottom>
            <Copyright />
        </template>
    </Layout>
</template>
<script lang="ts" setup>
import { computed, toRefs,onMounted,ref } from 'vue';
import { useData, useRouter } from 'vitepress';
import md5 from 'blueimp-md5';
import { usePlayerStore } from '../../store/player';
import DefaultTheme from 'vitepress/theme'
import Copyright from './Copyright.vue'
import Player from './Player.vue';
const { isPause } = toRefs(usePlayerStore());
const { page, theme, frontmatter, isDark } = useData();
const route = useRouter()
const { Layout } = DefaultTheme
const screenWidth = ref(document.body.clientWidth)
onMounted(() => {
// window.onresize = () => {
//             return (() => {
//                 screenWidth.value = document.body.clientWidth
//             })()
//         }
    })
</script>

<style scoped>
.snowbanner {
    position: absolute;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    z-index: 10;
    pointer-events: none;

    .img {
        width: 88%;
        height: fit-content;
        position: absolute;
        bottom: 0px;
        left: 50%;
        transform: translate(-50%);
    }
}

.snow {
    position: fixed;
    width: 100%;
    height: 100%;
    left: 0;
    top: 0;
    z-index: 99999;
    pointer-events: none;

    .img {
        width: 88%;
        height: fit-content;
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translate(-50%);
    }
}

.page404 {
    width: 224px;
    margin: 50px auto;
}
</style>
